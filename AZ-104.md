# AZ-104


---

## Monitoring

A service with netwoking tools for monitoring & diagnostics.

- overview of topologies
- monitor connectivity in Azure
- monitor & troubleshoot connectivity in hybrid networks
- troubleshoot connectivity issues
- enable per region in a subscription

---

### [Network Watcher](https://app.pluralsight.com/ilx/video-courses/aab7e697-581b-43f5-81b0-1fbf8cec5ac4/2641ff02-2e08-4382-93a4-14ad2995d093/4019ada2-9ada-46cb-b816-47a74299fee5)  


---

[What is Azure Network Watcher?](https://learn.microsoft.com/en-us/azure/network-watcher/network-watcher-overview)  

NW is a suite of tools to: 

- monitor
- diagnose
- view metrics 
- enable or disable logs for Azure IaaS (Infrastructure-as-a-Service) resources

It enables you to monitor and repair the network health of IaaS products like 

- virtual machines (VMs)
- virtual networks (VNets)
- application gateways
- load balancers
etc. 

> Network Watcher **isn't designed or intended for PaaS** monitoring **or Web analytics**.

### Important: Enable Network Watcher in the target Regions

[Enable Network Watcher for your region](https://learn.microsoft.com/en-us/azure/network-watcher/network-watcher-create?tabs=portal#enable-network-watcher-for-your-region)  

**If you choose to opt out of Network Watcher automatic enablement**, you must manually 
enable Network Watcher in each region where you want to use Network Watcher capabilities. 
You can opt out of Network Watcher automatic enablement using Azure PowerShell or Azure CLI.

[Enable or disable Azure Network Watcher](https://learn.microsoft.com/en-us/azure/network-watcher/network-watcher-create?tabs=portal)  

Network Watcher is enabled in an Azure region through the creation of a Network Watcher 
instance in that region. This instance allows you to utilize Network Watcher capabilities 
in that particular region.

**By default, Network Watcher is automatically enabled**. 

When you create or update a virtual network in your subscription, Network Watcher will be
automatically enabled in your Virtual Network's region.

In general, in any subscription some regions may have NW enabled and others may not have it.
However, you get the list of the enabled and disable regions and can control the 
NW enabled/disadble state on each region from:

> Network Watcher > Overview

- enabling Network Watcher doesn't affect your resources or associated charge.

---

Network Watcher consists of **three major sets of tools and capabilities**:

1. Monitoring
2. Network diagnostic tools
3. Traffic

---

### 1. Monitoring tools in Network Watcher

Network Watcher offers **two monitoring tools** that help you view and monitor resources:

- Topology:
provides a visualization of the entire network for understanding network configuration. 
It provides an interactive interface to view **resources and their relationships in Azure**
**spanning across multiple subscriptions, resource groups, and locations**. 
For more information, see Topology overview.

- Connection monitor:
Connection monitor provides end-to-end connection monitoring for Azure and hybrid endpoints.
It helps you **understand network performance between various endpoints** in your network 
infrastructure. 

---

### 2. Network diagnostic tools in Network Watcher

Network Watcher offers **seven network diagnostic tools** that help 
troubleshoot and diagnose network issues:

1. IP flow verify
2. NSG diagnostics
3. Next hop
4. Effective security rules
5. Connection troubleshoot
6. Packet capture
7. VPN troubleshoot


1. IP flow verify:
to detect traffic filtering issues at a virtual machine level. 
[Quickstart: Diagnose a virtual machine network traffic filter problem using the Azure portal](https://learn.microsoft.com/en-us/azure/network-watcher/diagnose-vm-network-traffic-filtering-problem)  

2. NSG diagnostics:

allows you to detect traffic filtering issues at the level of:
> a virtual machine
> virtual machine scale set
> application gateway

It checks if a packet is allowed or denied to or from an: 
- IP address
- IP prefix
- a service tag

It tells you which security rule allowed or denied the traffic.

3. Next hop
4. Effective security rules
5. Connection troubleshoot
6. Packet capture
7. VPN troubleshoot


---

### 3. Traffic Tools in Network Watcher

---
